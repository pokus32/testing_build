#:import datetime datetime
###:include lib.kv
###:include ..\\robo_control_report\\cr.kv
#:set norm_background_color (0.90,0.89,0.82,1)
#:set req_left_col 115
<DatePicker>:

    pHint: .3, .3


<TaskView>:
    spacing : "1dp"
    size_hint_y : None
    height : self.minimum_height
    orientation: 'horizontal'
    size_hint_y : None
    height : "31dp"
    task_id: '---'
    ppap_id: '---'
    quantity: '---'
    finish_date: '---'
    remove_bttn: remove_bttn
    bttn: bttn
    norm_background_color: [0.90,0.19,0.12,1]
    canvas:
        Color:
            rgb: (0, 0, 0, 1)
        Rectangle:
            size: self.size
            pos: self.pos
    BoxLayout:
        size_hint_x: None
        width: "61dp"
        canvas:
            Color:
                rgb: root.norm_background_color
            Rectangle:
                size: self.size
                pos: self.pos
        Label:
            background_color: norm_background_color
            text: root.task_id
            font_size : '13sp'
            color: 0,0,0,1
            halign : "left"
            valign : "middle"
    BoxLayout:
        # size_hint_x: None
        # width: 125
        canvas:
            Color:
                rgb: root.norm_background_color
            Rectangle:
                size: self.size
                pos: self.pos
        Label:
            background_color: norm_background_color
            text: root.ppap_id
            font_size : '13sp'
            color: 0,0,0,1
            halign : "left"
            valign : "middle"
    BoxLayout:
        size_hint_x: None
        width: "51dp"
        canvas:
            Color:
                rgb: root.norm_background_color
            Rectangle:
                size: self.size
                pos: self.pos
        Label:
            background_color: norm_background_color
            text: root.quantity
            font_size : '13sp'
            color: 0,0,0,1
            halign : "left"
            valign : "middle"
    BoxLayout:
        size_hint_x: None
        width: "57dp"
        canvas:
            Color:
                rgb: root.norm_background_color
            Rectangle:
                size: self.size
                pos: self.pos
        Label:
            background_color: norm_background_color
            text: root.finish_date
            font_size : '13dp'
            color: 0,0,0,1
            halign : "left"
            valign : "middle"
    BoxLayout:
        size_hint_x: None
        width: "66dp"
        canvas:
            Color:
                rgb: root.norm_background_color
            Rectangle:
                size: self.size
                pos: self.pos
        ToggleButton:
            size_hint_x: None
            width: "31dp"
            id: remove_bttn
            text: '√'
            font_size : '13sp'
            color: 0,0,0,1
            item_id: root.task_id
            on_state: root.set_mystate(self.state)
        ToggleButton:
            # background_color: norm_background_color
            id: bttn
            item_id: root.task_id
            group: 'edit'
            text: '∆'
            font_size : '13sp'
            color: 0,0,0,1
            on_state: root.mark_me(self.state)


<HeaderTask>:
    size_hint_y : None
    height : "47dp"
    canvas:
        Color:
            rgb: (0, 0, 0, 1)
        Rectangle:
            size: self.size
            pos: self.pos
    BoxLayout:
        spacing : "1dp"
        canvas:
            Color:
                rgb: (0, 0, 0, 1)
            Rectangle:
                size: self.size
                pos: self.pos
        BoxLayout:
            size_hint_x: None
            width: "61dp"
            canvas:
                Color:
                    rgb: root.norm_background_color
                Rectangle:
                    size: self.size
                    pos: self.pos
            Label:
                id: task_id
                text_size : self.size
                halign : "center"
                valign : "middle"
                color: 0,0,0,1
                text : "İş\nemri"
        BoxLayout:
            canvas:
                Color:
                    rgb: root.norm_background_color
                Rectangle:
                    size: self.size
                    pos: self.pos
            Label:
                id: ppap_id
                text_size : self.size
                halign : "center"
                valign : "middle"
                color: 0,0,0,1
                text : "PPAP\nadı/kodu"
        BoxLayout:
            size_hint_x: None
            width: "51dp"
            canvas:
                Color:
                    rgb: root.norm_background_color
                Rectangle:
                    size: self.size
                    pos: self.pos
            Label:
                id: parts_ammount
                text_size : self.size
                halign : "center"
                valign : "middle"
                color: 0,0,0,1
                text : "Siparış\nadeti"
        BoxLayout:
            size_hint_x: None
            width: "57dp"
            canvas:
                Color:
                    rgb: root.norm_background_color
                Rectangle:
                    size: self.size
                    pos: self.pos
            Label:
                id: delivery_date
                text_size : self.size
                halign : "center"
                valign : "middle"
                color: 0,0,0,1
                text : "Teslim\ntarihi"
        BoxLayout:
            size_hint_x: None
            width: "30dp"
            canvas:
                Color:
                    rgb: norm_background_color
                Rectangle:
                    size: self.size
                    pos: self.pos
            Label:
                text: 'Seç'
                font_size : '12dp'
                color: 0,0,0,1
        BoxLayout:
            size_hint_x: None
            width: "35dp"
            canvas:
                Color:
                    rgb: norm_background_color
                Rectangle:
                    size: self.size
                    pos: self.pos
            Label:
                # background_color: norm_background_color
                id: bttn
                text: 'Düzenle'
                font_size : '12dp'
                color: 0,0,0,1
                canvas.before:
                    PushMatrix
                    Rotate:
                        angle: 90
                        origin: self.center
                canvas.after:
                    PopMatrix


<NewTaskInput>:
    tasks_layout: tasks_layout
    task_input_form: task_input_form
    BoxLayout:
        id: middle_layout
        spacing : "1dp"
        orientation: 'vertical'
        BoxLayout:
            size_hint_y: None
            height: "11dp"
        TaskInputForm:
            id: task_input_form
            size_hint_y: None
            height: "101dp"
            prnt: root
        BoxLayout:
            orientation: "vertical"
            HeaderTask:
            BoxLayout:
                size_hint_y: None
                height: "1dp"
            TasksSView:
                GridLayout:
                    id: tasks_layout
                    cols: 1
                    spacing: "1dp"
                    size_hint_y: None
                    height: self.minimum_height


<TasksSView@ScrollView>:
    do_scroll_x: False
    do_scroll_y: True
    ##dobavleni canvas chtob scroll view ne vihodil za verhnuiu granicu roditelya!!!!!!!!!!!!!!!!
    canvas.before:
        StencilPush
        Rectangle:
            pos: self.pos
            size: self.size
        StencilUse

    canvas.after:
        StencilUnUse
        Rectangle:
            pos: self.pos
            size: self.size
        StencilPop


<FormButtons@BoxLayout>:
    spacing : "1dp"
    size_hint_y : None
    height : "30dp"
    parent: root
    canvas:
        Color:
            rgba: (0.1,0.1,0.1,0.3)
        Rectangle:
            size: self.size
            pos: self.pos
    BoxLayout:
        size_hint_x: None
        width: "120dp"
        canvas:
            Color:
                rgb: norm_background_color
            Rectangle:
                size: self.size
                pos: self.pos
        Button:
            text:'Form temizle'
            on_release: root.parent.clear_form()
    BoxLayout:
        size_hint_x: None
        width: "70dp"
        canvas:
            Color:
                rgb: norm_background_color
            Rectangle:
                size: self.size
                pos: self.pos
        Button:
            text:'Sil'
            on_release: root.parent.remove_marked_dims()
    BoxLayout:
    BoxLayout:
        size_hint_x: None
        width: "100dp"
        canvas:
            Color:
                rgb: norm_background_color
            Rectangle:
                size: self.size
                pos: self.pos
        Button:
            text:u'Ekle'
            on_release: root.parent.save_data()


<TaskInputForm>:
    task_id: task_id
    finish_date: finish_date
    ppap_id: ppap_id
    quantity: quantity
    rows_layout: rows_layout
    set_part_name_id: set_part_name_id
    orientation: "vertical"
    spacing: "1dp"
    BoxLayout:
        spacing : "1dp"
        size_hint_y : None
        height : "30dp"
        canvas:
            Color:
                rgb: (0, 0, 0, 1)
            Rectangle:
                size: self.size
                pos: self.pos
        BoxLayout:
            spacing : "1dp"
            canvas:
                Color:
                    rgb: (0, 0, 0, 1)
                Rectangle:
                    size: self.size
                    pos: self.pos
            BoxLayout:
                size_hint_x: None
                width: "81dp"
                canvas:
                    Color:
                        rgb: norm_background_color
                    Rectangle:
                        size: self.size
                        pos: self.pos
                Label:
                    text_size : self.size
                    halign : "right"
                    valign : "middle"
                    color: 0,0,0,1
                    text : "İş emri No: "
            BoxLayout:
                canvas:
                    Color:
                        rgb: norm_background_color
                    Rectangle:
                        size: self.size
                        pos: self.pos
                TextInput:
                    size_hint_x: None
                    width: "77dp"
                    id: task_id
                    on_text: root.set_new_task_id(self.text)
                    font_size : '12sp'
                    color: 0,0,0,1
                    write_tab: False
                BoxLayout:
                    canvas:
                        Color:
                            rgb: norm_background_color
                        Rectangle:
                            size: self.size
                            pos: self.pos
                    TextInput:
                        id: quantity
                        input_filter: 'int'
                        font_size : '12sp'
                        on_text: root.set_new_task_quantity(self.text)
                        color: 0,0,0,1
                        hint_text: 'Siparış adeti'
                        write_tab: False
                BoxLayout:
                    canvas:
                        Color:
                            rgb: norm_background_color
                        Rectangle:
                            size: self.size
                            pos: self.pos
                    TextInput:
                        # background_color: norm_background_color
                        id: finish_date
                        on_text: root.set_new_task_finish_date(self.text)
                        font_size : '12sp'
                        color: 0,0,0,1
                        write_tab: False
                        hint_text: 'Teslim tarihi'
    BoxLayout:
        spacing : "1dp"
        size_hint_y : None
        height : "30dp"
        canvas:
            Color:
                rgb: (0, 0, 0, 1)
            Rectangle:
                size: self.size
                pos: self.pos
        BoxLayout:
            spacing : "1dp"
            canvas:
                Color:
                    rgb: (0, 0, 0, 1)
                Rectangle:
                    size: self.size
                    pos: self.pos
            BoxLayout:
                size_hint_x: None
                width: "51dp"
                canvas:
                    Color:
                        rgb: norm_background_color
                    Rectangle:
                        size: self.size
                        pos: self.pos
                Label:
                    text_size : self.size
                    halign : "right"
                    valign : "middle"
                    color: 0,0,0,1
                    text : " PPAP: "
            BoxLayout:
                canvas:
                    Color:
                        rgb: norm_background_color
                    Rectangle:
                        size: self.size
                        pos: self.pos
                TextInput:
                    # background_color: norm_background_color
                    id: ppap_id
                    disabled: True
                    on_text: root.set_new_task_part_name_id()
                    font_size : '12sp'
                    color: 0,0,0,1
                    write_tab: False
            BoxLayout:
                size_hint_x: None
                width: "31dp"
                canvas:
                    Color:
                        rgb: norm_background_color
                    Rectangle:
                        size: self.size
                        pos: self.pos
                Button:
                    id: set_part_name_id
                    text: "<<"
                    on_release: root.select_ppap()
    FormButtons:
        parent: root
    BoxLayout:
        orientation: "vertical"
        TasksSView:
            GridLayout:
                id: rows_layout
                cols: 1
                spacing: "1dp"
                size_hint_y: None
                height: self.minimum_height


<PPAPsList>:
    ppaps_layout: ppaps_layout
    cancel_button: cancel_button
    rows: 2
    ScrollView:
        GridLayout:
            id: ppaps_layout
            cols: 1
            spacing: "1dp"
            size_hint_y: None
            height: self.minimum_height
    BoxLayout:
        size_hint_y: None
        height: "39dp"
        orientation: "horizontal"
        BoxLayout:
        Button:
            id: cancel_button
            size_hint_x: None
            width: "100dp"
            size_hint_y: None
            height: "35dp"
            text: 'Iptal'


<SinglePPAP>:
    aplay_button: aplay_button
    spacing: "1dp"
    size_hint_y: None
    height: "27dp"
    BoxLayout
        canvas:
            Color:
                rgba: norm_background_color
            Rectangle:
                size: self.size
                pos: self.pos
        Label:
            text: root.ppap_id_name
            color: 0,0,0,1
    Button:
        size_hint_x: None
        width: "27dp"
        text: '>>'
        id: aplay_button
